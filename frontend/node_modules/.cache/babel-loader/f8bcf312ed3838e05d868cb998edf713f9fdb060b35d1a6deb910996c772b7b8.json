{"ast":null,"code":"var _jsxFileName = \"C:\\\\project2025\\\\ShopBest\\\\frontend\\\\src\\\\components\\\\features\\\\AutoComplete.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { AutoComplete, Input } from 'antd';\nimport { setLocalQuery, resetSearchState, setSearchParameters } from '../../store/searchSlice';\nimport { resetFilter } from '../../store/filterSlice';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useQuery } from '@tanstack/react-query';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction useDebounce(value, delay) {\n  _s();\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  React.useEffect(() => {\n    const handler = setTimeout(() => setDebouncedValue(value), delay);\n    return () => clearTimeout(handler);\n  }, [value, delay]);\n  return debouncedValue;\n}\n_s(useDebounce, \"KDuPAtDOgxm8PU6legVJOb3oOmA=\");\nasync function fetchSuggestions(query) {\n  if (!query) return [];\n  const res = await fetch(`http://localhost:8000/api/suggestion?q=${encodeURIComponent(query)}`);\n  const data = await res.json();\n  return data.slice(0, 8);\n}\nexport function AutoCompletion() {\n  _s2();\n  const query = useSelector(state => state.search.local_query);\n  const search_parameters = useSelector(state => state.search.search_parameters);\n  const dispatch = useDispatch();\n  const debouncedQuery = useDebounce(query, 300);\n  const {\n    data: options = []\n  } = useQuery({\n    queryKey: ['suggestions', debouncedQuery],\n    queryFn: () => fetchSuggestions(debouncedQuery),\n    enabled: !!debouncedQuery,\n    staleTime: 5 * 60 * 1000\n  });\n  const onChange = value => {\n    dispatch(setLocalQuery(value));\n  };\n  const onSearch = value => {\n    dispatch(resetSearchState());\n    dispatch(resetFilter());\n    dispatch(setSearchParameters({\n      ...search_parameters,\n      q: value\n    }));\n  };\n  const onSelect = (_value, option) => {\n    dispatch(resetSearchState());\n    dispatch(resetFilter());\n    dispatch(setSearchParameters({\n      ...search_parameters,\n      q: option.label\n    }));\n    dispatch(setLocalQuery(option.label));\n  };\n  return /*#__PURE__*/_jsxDEV(AutoComplete, {\n    options: options,\n    style: {\n      width: 400\n    },\n    onChange: onChange,\n    onSelect: onSelect,\n    onSearch: onSearch,\n    value: query,\n    children: /*#__PURE__*/_jsxDEV(Input, {\n      placeholder: \"Search products\",\n      className: \"rounded-full shadow-md h-10\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n_s2(AutoCompletion, \"8xO9Nw9CKCXhcl41W/0F7v7z5F8=\", false, function () {\n  return [useSelector, useSelector, useDispatch, useDebounce, useQuery];\n});\n_c = AutoCompletion;\nvar _c;\n$RefreshReg$(_c, \"AutoCompletion\");","map":{"version":3,"names":["React","useState","AutoComplete","Input","setLocalQuery","resetSearchState","setSearchParameters","resetFilter","useSelector","useDispatch","useQuery","jsxDEV","_jsxDEV","useDebounce","value","delay","_s","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","fetchSuggestions","query","res","fetch","encodeURIComponent","data","json","slice","AutoCompletion","_s2","state","search","local_query","search_parameters","dispatch","debouncedQuery","options","queryKey","queryFn","enabled","staleTime","onChange","onSearch","q","onSelect","_value","option","label","style","width","children","placeholder","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/project2025/ShopBest/frontend/src/components/features/AutoComplete.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { AutoComplete, Input } from 'antd';\r\nimport { setLocalQuery, resetSearchState, setSearchParameters } from '../../store/searchSlice';\r\nimport { resetFilter } from '../../store/filterSlice';\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { useQuery } from '@tanstack/react-query';\r\n\r\nfunction useDebounce<T>(value: T, delay: number) {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  React.useEffect(() => {\r\n    const handler = setTimeout(() => setDebouncedValue(value), delay);\r\n    return () => clearTimeout(handler);\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n}\r\n\r\nasync function fetchSuggestions(query: string) {\r\n  if (!query) return [];\r\n  const res = await fetch(`http://localhost:8000/api/suggestion?q=${encodeURIComponent(query)}`);\r\n  const data = await res.json();\r\n  return data.slice(0, 8);\r\n}\r\n\r\nexport function AutoCompletion() {\r\n  const query = useSelector((state: any) => state.search.local_query);\r\n  const search_parameters = useSelector((state: any) => state.search.search_parameters);\r\n  const dispatch = useDispatch();\r\n  const debouncedQuery = useDebounce(query, 300);\r\n\r\n  const { data: options = [] } = useQuery({\r\n    queryKey: ['suggestions', debouncedQuery],\r\n    queryFn: () => fetchSuggestions(debouncedQuery),\r\n    enabled: !!debouncedQuery,\r\n    staleTime: 5 * 60 * 1000,\r\n  });\r\n\r\n  const onChange = (value: string) => {\r\n    dispatch(setLocalQuery(value));\r\n  };\r\n  const onSearch = (value: string) => {\r\n    dispatch(resetSearchState());\r\n    dispatch(resetFilter());\r\n    dispatch(setSearchParameters({\r\n      ...search_parameters,\r\n      q: value,\r\n    }));\r\n  };\r\n  const onSelect = (_value: string, option: any) => {\r\n    dispatch(resetSearchState());\r\n    dispatch(resetFilter());\r\n    dispatch(setSearchParameters({\r\n      ...search_parameters,\r\n      q: option.label,\r\n    }));\r\n    dispatch(setLocalQuery(option.label));\r\n  };\r\n\r\n  return (\r\n    <AutoComplete\r\n      options={options}\r\n      style={{ width: 400 }}\r\n      onChange={onChange}\r\n      onSelect={onSelect}\r\n      onSearch={onSearch}\r\n      value={query}\r\n    >\r\n      <Input\r\n        placeholder=\"Search products\"\r\n        className=\"rounded-full shadow-md h-10\"\r\n      />\r\n    </AutoComplete>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}